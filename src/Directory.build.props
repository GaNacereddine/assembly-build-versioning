<!--
WARNING: DO NOT MODIFY this file unless you are knowledgeable about MSBuild and have
         created a backup copy. Incorrect changes to this file will make it
         impossible to load or build your projects from the command-line or the IDE.

-->
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <RepoRoot>$(MSBuildThisFileDirectory)</RepoRoot>
    <RepoRelativeProjectDir>$([MSBuild]::MakeRelative($(RepoRoot), $(MSBuildProjectDirectory)))</RepoRelativeProjectDir>
    <BuildDir>$(RepoRoot)build</BuildDir>
    <VersionProps>$(BuildDir)\version.props</VersionProps>
    <CommonProps>$(RepoRoot)\common.props</CommonProps>
    <MiscProps>$(RepoRoot)\misc.props</MiscProps>
  </PropertyGroup>

  <Import Project="$(VersionProps)" Condition="Exists('$(VersionProps)')"/>
  <Import Project="$(CommonProps)" Condition="Exists('$(CommonProps)')"/>
  <Import Project="$(MiscProps)" Condition="Exists('$(MiscProps)')"/>

  <PropertyGroup>
    <DebugType>embedded</DebugType>
  </PropertyGroup>

  <PropertyGroup>
    <VersionPrefix Condition="'$(VersionPrefix)' != ''">$(VersionPrefix).$(VersionPatch).$(VersionRevision)</VersionPrefix>
    <VersionSuffix Condition="'$(VersionSuffix)' != '' AND '$(CI_BUILD_NUMBER)' != ''">$(VersionSuffix)+$(CI_BUILD_NUMBER)</VersionSuffix>
  </PropertyGroup>

  <!-- Adds the build date to the generated AssemblyInfo file, if the project
  has the $(GenerateAssemblyInfo) property set to true. This indirectly hooks
  in to the standard .NET SDK GenerateAssemblyInfo target by using the same
  ItemGroup names that GetAssemblyAttributes uses. This allows us to insert
  additional assembly attributes in to the set that's used. -->
  <ItemGroup>
    <AssemblyAttribute Include="System.Reflection.AssemblyMetadata" Condition="'$(BuildDate)' != '' and '$(GenerateAssemblyBuildDateAttribute)' == 'true'">
      <_Parameter1>BuildDate</_Parameter1>
      <_Parameter2>$(BuildDate)</_Parameter2>
    </AssemblyAttribute>
  </ItemGroup>
</Project>